<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src="libraries/jQuery-3.6.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
    <link href="libraries/Cerulean.css" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4-4.6.0/jq-3.6.0/dt-1.11.5/b-2.2.2/r-2.2.9/datatables.min.css" />

    <script type="text/javascript" src="https://cdn.datatables.net/v/bs4-4.6.0/jq-3.6.0/dt-1.11.5/b-2.2.2/r-2.2.9/datatables.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>

</head>
<body>

    <div id="progressWait">
        <img style="width:200px" src="../assets/AGau.gif" />
    </div>
    <script>

        
        
    </script>
    <div id="displayTables" style="display:none">
        <h1>Base Models</h1>
       

        <table style="padding: 20px; width: 100%" id="tableAssetAllocationModels" class="table table-striped dt-responsive nowrap">
            <thead>
                <tr>
                    <th>Model Name</th>
                    <th>Cash</th>
                    <th>Fixed Income</th>
                    <th>Sector</th>
                    <th>Small Cap</th>
                    <th>Mid Cap</th>
                    <th>Large Cap</th>
                    <th>Foreign</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>

    <div id="displayCharts" style="display:none">

    </div>
    <script>
        let dialogName;
        $(document).ready(function () {
            let cachedVar = parent.getCachedVar();
            //alert(cachedVar.id);

            const params = new Proxy(new URLSearchParams(window.location.search), {
                get: (searchParams, prop) => searchParams.get(prop),
            });
            // Get the value of "some_key" in eg "https://example.com/?some_key=some_value"
            dialogName = params.dialogname; // "some_value"
            ///call the webmethod
            setTimeout(getAssetAllocationBaseModels, 2000);

        })

        function getAssetAllocationBaseModels() {
            ///create requestObject
            let requestObject = {};
            ///API Method Routing Method Name
            requestObject.MethodName = "GetAllQuery";
            ///Name of the Stored PRocedure to Call
            requestObject.ProcName = "GetAssetAllocationBaseModels";
            ///Return a JSON String
            requestObject.ReturnType = "json";

            let request = JSON.stringify(requestObject);
            parent.showNotificationBar('Getting the Asset Allocation Base Models ');
            if (parent.Post2Server(request, 'getAssetAllocationBaseModels').statusText == 'success') { 
                //hide progress
                $('#progressWait').hide();
                //$('#displayTables').append(`<div>${JSON.parse(parent.getAssetAllocationBaseModels())[0].ModelName}</div>`)
                $('#displayTables').show();
                formTable(JSON.parse(parent.getAssetAllocationBaseModels()));
            }
        }

        function formTable(jsonObjectArray) {
            var rows;

            $.each(jsonObjectArray, function (key, value) {
                rows += `<tr><td><button id="button_${value.ModelName}" style="width:150px" class="btn btn-outline-primary buttonforclick" ` +
                    `onclick="LaunchChart('${value.ModelName}')" >` +
                    `${value.ModelName}</button></td><td>${value.Cash}<img source</td><td>` +
                    `${value.FixedIncome}</td><td>${value.Sector}</td><td>` +
                    `${value.SmallCapStocks}</td><td>${value.MidCapStocks}</td><td>` +
                    `${value.LargeCapStocks}</td><td>${value.Global}</td></tr>`; 
            });
            
            $("#displayTables tbody").append(rows);

            $('#tableAssetAllocationModels').DataTable({ responsive: true });
        }

        $('.buttonforclick').click(function (id) {
           
        })
        function LaunchChart(modelName) {
            let frameObject = {};
            frameObject.applicationName = 'assetAllocationBaseModelChart';
            frameObject.basemodel = modelName;
            frameObject.title = modelName;
            parent.createFrame(frameObject);
        }
        function Close() {
            parent.RemoveWindow(dialogName);
        }

    </script>
</body>
</html>